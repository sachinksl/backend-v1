{"ast":null,"code":"var _jsxFileName = \"/Users/sachinkansal/seller-disclosure-portal/src/components/DocumentPanel.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport { Box, Typography, List, ListItem, ListItemText, Button, TextField, MenuItem } from '@mui/material';\nimport { listDocuments, presignUpload, completeUpload } from '../api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst KINDS = [{\n  id: 'title_search',\n  label: 'Title search document'\n}, {\n  id: 'pool_safety',\n  label: 'Pool safety certificate'\n}, {\n  id: 'smoke_alarm',\n  label: 'Smoke alarm compliance'\n}, {\n  id: 'bcorp_info',\n  label: 'Body corporate information'\n}];\nexport default function DocumentPanel({\n  propertyId,\n  onChanged,\n  initialKind\n}) {\n  _s();\n  const [docs, setDocs] = useState([]);\n  const [kind, setKind] = useState(initialKind || 'title_search');\n  const [file, setFile] = useState(null);\n  const [busy, setBusy] = useState(false);\n  useEffect(() => {\n    if (initialKind) setKind(initialKind);\n  }, [initialKind]);\n  async function refresh() {\n    const list = await listDocuments(propertyId);\n    setDocs(list);\n  }\n  useEffect(() => {\n    refresh();\n  }, [propertyId]);\n  const upload = async () => {\n    if (!file) return;\n    setBusy(true);\n    try {\n      const {\n        uploadUrl,\n        key\n      } = await presignUpload(propertyId, {\n        filename: file.name,\n        kind\n      });\n\n      // PUT the file directly to S3\n      const put = await fetch(uploadUrl, {\n        method: 'PUT',\n        body: file\n      });\n      if (!put.ok) throw new Error('upload failed');\n\n      // tell backend to create DB row\n      await completeUpload(propertyId, {\n        key,\n        filename: file.name,\n        kind\n      });\n      setFile(null);\n      await refresh();\n      onChanged === null || onChanged === void 0 ? void 0 : onChanged(); // tell parent to recompute progress\n    } catch (e) {\n      console.error(e);\n      alert(e.message);\n    } finally {\n      setBusy(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Box, {\n    mt: 3,\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h6\",\n      gutterBottom: true,\n      children: \"Documents\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      gap: 2,\n      alignItems: \"center\",\n      mb: 2,\n      children: [/*#__PURE__*/_jsxDEV(TextField, {\n        select: true,\n        label: \"Kind\",\n        size: \"small\",\n        value: kind,\n        onChange: e => setKind(e.target.value),\n        sx: {\n          minWidth: 280\n        },\n        children: KINDS.map(k => /*#__PURE__*/_jsxDEV(MenuItem, {\n          value: k.id,\n          children: k.label\n        }, k.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 27\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        onChange: e => {\n          var _e$target$files$, _e$target$files;\n          return setFile((_e$target$files$ = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0]) !== null && _e$target$files$ !== void 0 ? _e$target$files$ : null);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        disabled: !file || busy,\n        variant: \"contained\",\n        onClick: upload,\n        children: \"Upload\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(List, {\n      children: docs.map(d => /*#__PURE__*/_jsxDEV(ListItem, {\n        divider: true,\n        children: /*#__PURE__*/_jsxDEV(ListItemText, {\n          primary: `${d.kind} — ${d.filename}`,\n          secondary: `Uploaded ${new Date(d.createdAt).toLocaleString()}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 13\n        }, this)\n      }, d.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 5\n  }, this);\n}\n_s(DocumentPanel, \"wBOZjOgqrvkY8Gh10bxfUmmOAIs=\");\n_c = DocumentPanel;\nvar _c;\n$RefreshReg$(_c, \"DocumentPanel\");","map":{"version":3,"names":["useEffect","useState","Box","Typography","List","ListItem","ListItemText","Button","TextField","MenuItem","listDocuments","presignUpload","completeUpload","jsxDEV","_jsxDEV","KINDS","id","label","DocumentPanel","propertyId","onChanged","initialKind","_s","docs","setDocs","kind","setKind","file","setFile","busy","setBusy","refresh","list","upload","uploadUrl","key","filename","name","put","fetch","method","body","ok","Error","e","console","error","alert","message","mt","children","variant","gutterBottom","fileName","_jsxFileName","lineNumber","columnNumber","display","gap","alignItems","mb","select","size","value","onChange","target","sx","minWidth","map","k","type","_e$target$files$","_e$target$files","files","disabled","onClick","d","divider","primary","secondary","Date","createdAt","toLocaleString","_c","$RefreshReg$"],"sources":["/Users/sachinkansal/seller-disclosure-portal/src/components/DocumentPanel.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { Box, Typography, List, ListItem, ListItemText, Button, TextField, MenuItem } from '@mui/material';\nimport { listDocuments, presignUpload, completeUpload } from '../api';\n\nconst KINDS = [\n  { id: 'title_search', label: 'Title search document' },\n  { id: 'pool_safety',  label: 'Pool safety certificate' },\n  { id: 'smoke_alarm',  label: 'Smoke alarm compliance' },\n  { id: 'bcorp_info',   label: 'Body corporate information' },\n];\n\nexport default function DocumentPanel({ propertyId, onChanged, initialKind }) {\n  const [docs, setDocs] = useState([]);\n  const [kind, setKind] = useState(initialKind || 'title_search');\n  const [file, setFile] = useState(null);\n  const [busy, setBusy] = useState(false);\n\n  useEffect(() => { if (initialKind) setKind(initialKind); }, [initialKind]);\n\n  async function refresh() {\n    const list = await listDocuments(propertyId);\n    setDocs(list);\n  }\n  useEffect(() => { refresh(); }, [propertyId]);\n\n  const upload = async () => {\n    if (!file) return;\n    setBusy(true);\n    try {\n      const { uploadUrl, key } = await presignUpload(propertyId, { filename: file.name, kind });\n\n      // PUT the file directly to S3\n      const put = await fetch(uploadUrl, { method: 'PUT', body: file });\n      if (!put.ok) throw new Error('upload failed');\n\n      // tell backend to create DB row\n      await completeUpload(propertyId, { key, filename: file.name, kind });\n\n      setFile(null);\n      await refresh();\n      onChanged?.(); // tell parent to recompute progress\n    } catch (e) {\n      console.error(e);\n      alert(e.message);\n    } finally {\n      setBusy(false);\n    }\n  };\n\n  return (\n    <Box mt={3}>\n      <Typography variant=\"h6\" gutterBottom>Documents</Typography>\n\n      <Box display=\"flex\" gap={2} alignItems=\"center\" mb={2}>\n        <TextField\n          select\n          label=\"Kind\"\n          size=\"small\"\n          value={kind}\n          onChange={(e)=>setKind(e.target.value)}\n          sx={{ minWidth: 280 }}\n        >\n          {KINDS.map(k => <MenuItem key={k.id} value={k.id}>{k.label}</MenuItem>)}\n        </TextField>\n\n        <input type=\"file\" onChange={(e)=>setFile(e.target.files?.[0] ?? null)} />\n        <Button disabled={!file || busy} variant=\"contained\" onClick={upload}>Upload</Button>\n      </Box>\n\n      <List>\n        {docs.map(d => (\n          <ListItem key={d.id} divider>\n            <ListItemText\n              primary={`${d.kind} — ${d.filename}`}\n              secondary={`Uploaded ${new Date(d.createdAt).toLocaleString()}`}\n            />\n          </ListItem>\n        ))}\n      </List>\n    </Box>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}